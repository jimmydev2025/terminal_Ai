(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9331:(e,t,s)=>{Promise.resolve().then(s.bind(s,5903))},5903:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),r=s(2115),i=s(4367),l=s(1536),n=s(1589),o=s(3797),c=s(468),d=s(864),m=s(6046),h=s(6280);function p(){let[e,t]=(0,r.useState)(!1),[s,i]=(0,r.useState)(null),l=(0,m.useRouter)(),n=()=>t(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>t(!0),className:"bg-purple-800 text-white px-2 rounded h-8 hover:bg-purple-900",children:["New Game ",(0,a.jsx)(h.BD5,{className:"inline"})]}),(0,a.jsx)(c.e,{appear:!0,show:e,as:r.Fragment,children:(0,a.jsxs)(d.lG,{as:"div",className:"relative z-10",onClose:n,children:[(0,a.jsx)(c.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(c.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(d.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-neutral-950 p-6 text-left align-middle shadow-xl transition-all",children:[(0,a.jsx)(d.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-yellow-500 text-center",children:"Choose a game mode:"}),(0,a.jsx)("div",{className:"mt-4 space-y-2",children:Object.entries(o).map(e=>{let[t,r]=e;return(0,a.jsxs)("button",{onClick:()=>i(t),className:"w-full px-4 py-2 rounded-lg text-left border border-purple-500 ".concat(s===t?"bg-purple-600 text-white":"bg-black hover:bg-neutral-950 text-white"),disabled:!r.ENABLED,children:[r.SHORT_DESC," "]},t)})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:n,className:"px-4 py-2 text-white bg-neutral-600 rounded-lg hover:bg-neutral-700",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{if(s){let e="".concat(o[s].PATH).concat(s);l.push(e),n()}else alert("Please select a game mode.")},className:"px-4 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700",children:"Start Game"})]})]})})})})]})})]})}function u(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(1),[d,m]=(0,r.useState)(1),[h,u]=(0,r.useState)("latest"),[x,g]=(0,r.useState)(!1);async function E(e,s){g(!0);try{let a=await fetch("/api/getGames?page=".concat(e,"&pageSize=").concat(5,"&sort=").concat(s));if(!a.ok)throw Error("Failed to fetch games");let r=await a.json(),i=await Promise.all(r.games.map(async e=>{if(!e.game_type||"normal"===e.game_type){let t=await S(e.session_id);return{...e,interactions:t}}return{...e,interactions:null}}));t(i),m(r.totalPages)}catch(e){console.error("Error fetching games:",e)}finally{g(!1)}}async function S(e){try{let t=await fetch("/api/getInteractions?session_id=".concat(e));if(!t.ok)throw Error("Failed to fetch interactions");return(await t.json()).interactions}catch(t){return console.error("Error fetching interactions for session ".concat(e,":"),t),[]}}function N(e,s){let a=JSON.parse(localStorage.getItem("votedSessions"))||[];if(a.includes(e)){alert("Double submissions? What do you think this is, Medicare?");return}localStorage.setItem("votedSessions",JSON.stringify([...a,e])),fetch("/api/saveVote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,vote:s})}).then(a=>{if(!a.ok)throw Error("Failed to save vote");alert("Your vote is the only thing we'll approve today"),t(t=>t.map(t=>t.session_id===e?{...t,votes:(t.votes||0)+s}:t))}).catch(e=>{console.error("Error saving vote:",e)})}return(0,r.useEffect)(()=>{E(s,h)},[s,h]),(0,a.jsxs)("div",{className:"p-2 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)(p,{}),(0,a.jsxs)("select",{value:h,onChange:e=>u(e.target.value),className:"text-white bg-purple-950 border border-purple-900 px-4 rounded h-8",children:[(0,a.jsx)("option",{value:"latest",children:"Latest"}),(0,a.jsx)("option",{value:"mostVoted",children:"Most Voted"})]})]}),x?(0,a.jsxs)("h3",{className:"text-center text-gray-300 text-lg flex justify-center items-center",children:[(0,a.jsx)(l.hW,{className:"mr-2 animate-spin"})," Loading games..."]}):0===e.length?(0,a.jsx)("p",{className:"text-center text-gray-300 text-lg",children:"Please wait..."}):e.map(e=>{var t;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs flex flex-row gap-4 py-2 text-purple-800 uppercase",children:[(0,a.jsx)("div",{children:(null===(t=e.user_id)||void 0===t?void 0:t.wallet_address)&&(0,a.jsxs)("p",{children:["PLAYER: ",e.user_id.wallet_address.slice(-6)]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{children:["DATE:"," ",new Date(e.timestamp).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{children:["MODE: ",e.game_mode]})})]}),(0,a.jsxs)("div",{id:"game-border",className:"shadow-md p-0.5 mb-8 rounded bg-gradient-to-br from-purple-900 to-indigo-900 hover:from-purple-950 hover:to-indigo-950",children:[(0,a.jsxs)("div",{className:"py-0.5 px-1 flex items-center justify-between text-white hover:text-green-500",children:["story"===e.game_type?(0,a.jsx)("a",{href:"/completed/story/".concat(e._id),children:(0,a.jsx)("p",{children:e.title})}):(0,a.jsx)("a",{href:"/completed/".concat(e._id),children:(0,a.jsx)("p",{children:e.title})}),(0,a.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,a.jsx)("div",{className:"rounded-full p-1 border border-purple-700 bg-purple-800"}),(0,a.jsx)("div",{className:"rounded-full p-1 border border-purple-700 bg-purple-800"}),(0,a.jsx)("div",{className:"rounded-full p-1 border border-purple-700 bg-purple-800"})]})]}),(0,a.jsxs)("div",{id:"game-content",className:"bg-slate-950",children:[(0,a.jsxs)("div",{id:"game-chat",className:"mt-2 p-2 bg-black max-h-60 overflow-y-auto",children:[(0,a.jsx)("p",{className:"text-yellow-600 mb-2",children:(null==e?void 0:e.role)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:"GAME ROLE:"})," ",e.role]}):null}),"story"!==e.game_type?Array.isArray(e.interactions)&&e.interactions.length>0?e.interactions.map((t,s)=>(0,a.jsxs)("div",{className:"".concat("user"===t.role?"text-blue-600":"text-green-600"," mb-2"),children:["[",new Date(t.timestamp).toLocaleTimeString(),"]"," ",(0,a.jsxs)("strong",{children:["user"===t.role?"User":o[e.game_mode].AI_ROLE,":"]})," ",(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:t.message.replace(/\*\*\*/g,"")})]},s)):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No interactions found for this game."}):Array.isArray(e.moves)&&e.moves.length>0?e.moves.map((e,t)=>(0,a.jsxs)("div",{className:"text-sm mb-2 whitespace-pre-wrap",children:[(0,a.jsxs)("p",{className:"text-green-500 mb-2",children:[(0,a.jsxs)("strong",{children:["[",new Date(e.timestamp).toLocaleTimeString(),"]"," ","AI:"]}),(0,a.jsx)("br",{}),e.node_text]}),e.choice&&(0,a.jsxs)("p",{className:"text-blue-500 mb-2",children:[(0,a.jsx)("strong",{children:"Player:"})," ",e.choice||"N/A"]})]},t)):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No moves found for this game."})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,a.jsxs)("span",{className:"font-bold ".concat("win"===e.outcome?"text-green-500":"text-red-500"),children:["Outcome: ",e.outcome.toUpperCase(),(0,a.jsx)("br",{})]}),(0,a.jsxs)("span",{className:"text-gray-500 font-medium",children:["Votes: ",e.votes||0]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>N(e.session_id,1),className:"text-gray-500 p-2 rounded-full mr-2 hover:bg-slate-900 hover:text-cyan-500",children:(0,a.jsx)(n.U2A,{})}),(0,a.jsx)("button",{onClick:()=>N(e.session_id,-1),className:"text-gray-500 p-2 rounded-full mr-2 hover:bg-slate-900 hover:text-cyan-500 scale-x-[-1]",children:(0,a.jsx)(n.rYl,{})})]})]})]})]},e.session_id)]},e.session_id)}),(0,a.jsxs)("div",{className:"flex justify-center mt-6",children:[(0,a.jsxs)("button",{onClick:()=>c(e=>Math.max(e-1,1)),disabled:1===s,className:"bg-purple-800 text-white px-4 py-2 rounded mr-2 disabled:bg-gray-800 items-center flex",children:[(0,a.jsx)(i.v2Y,{className:"inline mr-2"}),"Previous"]}),(0,a.jsxs)("button",{onClick:()=>c(e=>Math.min(e+1,d)),disabled:s===d,className:"bg-purple-800 text-white px-4 py-2 rounded disabled:bg-gray-800 items-center flex",children:["Next ",(0,a.jsx)(i.eWJ,{className:"inline ml-2"})]})]}),(0,a.jsxs)("p",{className:"text-center text-sm text-gray-500 mt-4",children:["Page ",s," of ",d]})]})}},3797:e=>{"use strict";e.exports=JSON.parse('{"mafia_wars":{"SHORT_DESC":"\uD83E\uDD0C Mafia Wars","ENABLED":true,"SUCCESS":"","FAIL":"","BUTTON_SUCCESS":"SUCCESS! Play Again","BUTTON_FAIL":"FAILURE! Try Again","AI_ROLE":"Agent","PLAYER_ROLE":"You belong to the mafia","PATH":"/game/story/","SYSTEM_PROMPT":"System: Welcome to mafia wars. Please Start Game to begin.","NOTE_FOR_TITLE_GENERATION":""},"zombies":{"SHORT_DESC":"☣️ Zombie Apocalypse","ENABLED":true,"SUCCESS":"","FAIL":"","BUTTON_SUCCESS":"SURVIVED! Play Again","BUTTON_FAIL":"LOST! Try Again","AI_ROLE":"Agent","PLAYER_ROLE":"Survive the Apocalypse","PATH":"/game/story/","SYSTEM_PROMPT":"System: Welcome to the Zombie Apocalypse! Press Start Game to begin","NOTE_FOR_TITLE_GENERATION":""},"prison_break":{"SHORT_DESC":"\uD83C\uDFC3 Prison Break","ENABLED":true,"SUCCESS":"","FAIL":"","BUTTON_SUCCESS":"ESCAPED! Play Again","BUTTON_FAIL":"LOST! Try Again","AI_ROLE":"Agent","PLAYER_ROLE":"Escape from prison","PATH":"/game/story/","SYSTEM_PROMPT":"System: Welcome to the Prison Break! Press Start Game to begin.","NOTE_FOR_TITLE_GENERATION":""},"shark_stank":{"SHORT_DESC":"\uD83E\uDD88 Shark Stank: Pitch or Get Dumped","ENABLED":true,"SUCCESS":"***INVESTMENT SECURED***","FAIL":"***ALL SHARKS ARE OUT***","BUTTON_SUCCESS":"INVESTED! Start a New Pitch","BUTTON_FAIL":"REJECTED! Back to the Drawing Board","AI_ROLE":"Shark","PATH":"/game/","SYSTEM_PROMPT":"System: Pitch your product to the sharks!","NOTE_FOR_TITLE_GENERATION":"The USER is pitching a ridiculous product or company idea to the AGENT, who plays the role of snarky investors known as the \'Sharks\'. The USER must convince the sharks to invest while avoiding being mocked or rejected."},"marketer":{"SHORT_DESC":"\uD83D\uDCB0 Scam Artist Simulator","ENABLED":true,"SUCCESS":"***SALE CLOSED***","FAIL":"***SALE REJECTED***","BUTTON_SUCCESS":"SOLD! Find Next Victim","BUTTON_FAIL":"REJECTED! Apply at McDonald\'s","AI_ROLE":"Client","PATH":"/game/","SYSTEM_PROMPT":"System: Type your first message to kick off the sale!","NOTE_FOR_TITLE_GENERATION":"The user is a degenerate sales person and is trying to make a sale. The AGENT in this conversation is a potential client."},"insurance":{"SHORT_DESC":"\uD83D\uDC89 United Healthscare: Claims From Hell","ENABLED":true,"SUCCESS":"***CLAIM APPROVED***","FAIL":"***CLAIM DENIED***","BUTTON_SUCCESS":"APPROVED! Play Again","BUTTON_FAIL":"DENIED! Try Again","AI_ROLE":"Agent","PATH":"/game/","SYSTEM_PROMPT":"System: Please start with your name, an agent will be with you shortly.","NOTE_FOR_TITLE_GENERATION":"The USER is trying to file an insurance claim, the AGENT is a claim adjuster for the greedy company called United Healthscare"}}')}},e=>{var t=t=>e(e.s=t);e.O(0,[711,512,206,446,407,441,517,358],()=>t(9331)),_N_E=e.O()}]);